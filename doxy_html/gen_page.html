<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ArnLib: General Description</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ArnLib
   &#160;<span id="projectnumber">4.0.x</span>
   </div>
   <div id="projectbrief">Active Registry Network</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('gen_page.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">General Description </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#gen_arnobj">Arn Data Objects    </a><ul><li class="level2"><a href="#gen_arnItem">ArnItem access   </a></li>
<li class="level2"><a href="#gen_arnobjModes">Modes    </a></li>
<li class="level2"><a href="#gen_localPath">Local    </a></li>
<li class="level2"><a href="#gen_naming">Naming conventions    </a></li>
<li class="level2"><a href="#gen_bidirArnobj">Bidirectional Arn Data Objects    </a></li>
<li class="level2"><a href="#gen_pipeArnobj">Pipe Arn Data Objects    </a><ul><li class="level3"><a href="#gen_pipeSeqCheck">Pipe sequence check</a></li>
<li class="level3"><a href="#gen_pipeAntiCongest">Pipe anti congest</a></li>
</ul>
</li>
<li class="level2"><a href="#gen_persistArnobj">Persistent Arn Data Objects    </a><ul><li class="level3"><a href="#gen_fileArnobj">Saving objects in files</a></li>
</ul>
</li>
<li class="level2"><a href="#gen_shareArnobj">Sharing Arn Data Objects    </a><ul><li class="level3"><a href="#gen_dynamicPort">Dynamic port</a></li>
</ul>
</li>
<li class="level2"><a href="#gen_syncRules">Sync rules    </a><ul><li class="level3"><a href="#gen_syncRulesPipe">Sync rules for Pipe</a></li>
<li class="level3"><a href="#gen_syncRulesMode">ClientSyncMode</a></li>
</ul>
</li>
</ul>
</li>
<li class="level1"><a href="#gen_rpc">RPC and SAPI    </a><ul><li class="level2"><a href="#gen_rpcoverload">RPC and SAPI method name overload    </a></li>
<li class="level2"><a href="#gen_rpcformat">RPC and SAPI communication format    </a></li>
</ul>
</li>
<li class="level1"><a href="#gen_zeroconf">ZeroConfig    </a><ul><li class="level2"><a href="#gen_zeroconfDef">ZeroConfig definitions    </a><ul><li class="level3"><a href="#gen_zeroconfServiceName">Service name</a></li>
<li class="level3"><a href="#gen_zeroconfSubTypes">Sub types</a></li>
<li class="level3"><a href="#gen_zeroconfTextRecord">Text record</a></li>
</ul>
</li>
<li class="level2"><a href="#gen_discover">Discover    </a></li>
<li class="level2"><a href="#gen_discoverRemote">Discover remote    </a></li>
</ul>
</li>
<li class="level1"><a href="#gen_appnote">Application notations    </a></li>
</ul>
</div>
<div class="textblock"><p>This document describes the general concepts of the ArnLib. <br />
<br />
</p>
<h1><a class="anchor" id="gen_arnobj"></a>
Arn Data Objects    </h1>
<p>All objects are stored in a tree hierarchy and the naming is similar to typical file systems, e.g. "//Measure/Water/Temperature/value".</p>
<p>To get a handle to a folder, use a path ending with "/", e.g "//Measure/Water/".</p>
<p>Folder names can be empty. In the above example, the first level folder is empty and the second level folder is "Measure". The empty folder name can also be referred as "@". Again, the example can equally be written "/@/Measure/Water/Temperature/value". This "@" is typically used when an empty name is unacceptable, e.g. in the tree viewer of the ArnBrowser tool.</p>
<p>A relative path is also called the <a href="#gen_localPath">local path</a>, e.g. "Sys/Discover/This/Service/value".</p>
<p>Each part in a given path is dynamically added as needed, i.e. any path can be used without explicitly creating each folder in advance. <br />
<br />
</p>
<h2><a class="anchor" id="gen_arnItem"></a>
ArnItem access   </h2>
<p>To access an <em>ARN Data Object</em> one can use <a class="el" href="class_arn_m.html#ad762cbc4fe1386747e35dd892880af36" title="Assign an integer to an Arn Data Object at path ">ArnM::setValue()</a> and <a class="el" href="class_arn_m.html#aed7669788b70681dddf639866f46f02c" title="Get the value of Arn Data Object at path ">ArnM::valueInt()</a> etc. This is a polled access, and gives no signals / events for changed objects. Also this method is rather slow as it has to locate the object via a path lookup. However its good for application assign object "once".</p>
<p>For continous access to an <em>ARN Data Object</em> its better to use an <a class="el" href="class_arn_item.html" title="Handle for an Arn Data Object. ">ArnItem</a>. This will be a handle to the object that give fast access. It will also provide signals for changed object. <a class="el" href="class_arn_item.html" title="Handle for an Arn Data Object. ">ArnItem</a> is QObject based and has its charateristics.</p>
<p>Yet another way to access an <em>ARN Data Object</em>, is an <a class="el" href="class_arn_basic_item.html" title="Base class handle for an Arn Data Object. ">ArnBasicItem</a>. This will give a basic handle to the object. It is fast, small and is not based on QObject. As such it can not use signals and slots, but it can provide ArnEvents.</p>
<p>Normally <a class="el" href="class_arn_item.html" title="Handle for an Arn Data Object. ">ArnItem</a> should be used, as it has a higher level interface with QObject signals and slots. Typically <a class="el" href="class_arn_basic_item.html" title="Base class handle for an Arn Data Object. ">ArnBasicItem</a> is used when no signal is needed, i.e only using direct access with setValue and toXXX methods. If you need a lot of ArnBasicItems and memory foot print (or speed) is important, You can consider to use <a class="el" href="class_arn_basic_item.html" title="Base class handle for an Arn Data Object. ">ArnBasicItem</a> with ArnEvents even if it will be harder to code.</p>
<p>You can expect <a class="el" href="class_arn_basic_item.html" title="Base class handle for an Arn Data Object. ">ArnBasicItem</a> to be lees than a third of the size of an <a class="el" href="class_arn_item.html" title="Handle for an Arn Data Object. ">ArnItem</a>. Tests has shown <a class="el" href="class_arn_basic_item.html" title="Base class handle for an Arn Data Object. ">ArnBasicItem</a> to take half the time assigning an integer, compared to <a class="el" href="class_arn_item.html" title="Handle for an Arn Data Object. ">ArnItem</a>. <br />
<br />
</p>
<h2><a class="anchor" id="gen_arnobjModes"></a>
Modes    </h2>
<p><em>Mode</em> change is a one direction process. Once a specific <em>mode</em> is set, it can't be reset.</p>
<p>If the <a class="el" href="class_arn_item.html" title="Handle for an Arn Data Object. ">ArnItem</a> is in a closed state when the <em>mode</em> change is done, the added modes will be stored and the real <em>mode</em> change is done when the <a class="el" href="class_arn_item.html" title="Handle for an Arn Data Object. ">ArnItem</a> is opened to an <em>ARN Data Object</em>.</p>
<p>If the <em>general mode</em> change is done to a <a href="#gen_shareArnobj">shared</a> object, the change of <em>general mode</em> is also done at the server and any connected clients.</p>
<p>The following <em>general modes</em> are available:</p>
<ul>
<li><b>BiDir</b> A two-way object, typically for validation or pipe. See <a href="#gen_bidirArnobj">bidirectional</a> objects.</li>
<li><b>Pipe</b> Implies <em>BiDir</em> and all data is preserved as a stream during <a href="#gen_shareArnobj">sharing</a>. Without <em>Pipe mode</em>, <a href="#gen_shareArnobj">sharing</a> is optimized to sync latest value and not all values in a stream.</li>
<li><b>Save</b> Sets the <em>ARN Data Object</em> as persistent and any data assigned to it will be saved. The persistent service must be started at the server. See <a href="#gen_persistArnobj">persistent</a> objects.</li>
</ul>
<p>Additionally there are some <em>sync modes</em>. These modes are used by the local client session and are not shared with others. The <em>sync modes</em> must be set before the <a class="el" href="class_arn_item.html" title="Handle for an Arn Data Object. ">ArnItem</a> is opened to an <em>ARN Data Object</em>.</p>
<p>Following <em>sync_modes</em> are available:</p>
<ul>
<li><b>Master</b> The <em>ARN Data Object</em> (at client side) is set as <em>default generator</em> of data. Normally the server is the <em>default generator</em> of data. See <a href="#gen_syncRules">Sync Rules</a>.</li>
<li><b>AutoDestroy</b> The <em>ARN Data Object</em> (at client side) is set up for auto destruction. When the client closes tcp/ip, the server side will destroy the <em>ARN Data Object</em> and this will also be done at any connected clients.</li>
</ul>
<p>Note: It's convenient to always set all the needed modes before an <a class="el" href="class_arn_item.html" title="Handle for an Arn Data Object. ">ArnItem</a> is opened or an <a class="el" href="class_arn_item.html" title="Handle for an Arn Data Object. ">ArnItem</a> is used as a template. See <a class="el" href="class_arn_item.html#ad0abf36e61104c113f46503bfcf4f39a" title="Mark this ArnItem as a template. ">ArnItem::setTemplate()</a>. <br />
<br />
</p>
<h2><a class="anchor" id="gen_localPath"></a>
Local    </h2>
<p>A relative path is also called the <em>local path</em>, e.g. the <a href="#gen_discoverRemote">Discover remote</a> <em>service name</em> at path "Sys/Discover/This/Service/value". The <em>local path</em> is mapped to the absolute path "/Local/". The example is then equal to "/Local/Sys/Discover/This/Service/value". The <em>local path</em> should not be <a href="#gen_shareArnobj">shared</a> as it will contain specific data for its running program.</p>
<p>The exception to not sharing <em>local path</em> is for some kind of remote client that must be able to change an <em>ARN Data Object</em> in the <em>local path</em> at the remoted target. For example this is used to change the <a href="#gen_discoverRemote">Discover remote</a> <em>service name</em> for a target host.</p>
<p>Note: Do always mount the <em>local path</em> of the server at a different path at the client. This is to avoid collision with the client's own <em>local path</em> data.</p>
<p>In the above example, a remote client using <a class="el" href="class_arn_client.html#ac417b3db210850f4bea8abcf78bf1237" title="Add a sharing tree path. ">ArnClient::addMountPoint</a>("/@HostLocal/", "/Local/") will share and access the <a href="#gen_discoverRemote">Discover remote</a> <em>service name</em> at the path "/@HostLocal/Sys/Discover/This/Service/value". <br />
<br />
</p>
<h2><a class="anchor" id="gen_naming"></a>
Naming conventions    </h2>
<p>These rules must not be obeyed, but are recommended, to get the most benefits of the Arn echo system, like the ArnBrowser tool.</p>
<ul>
<li>First level folder empty, e.g. "//MyGlobalFolder/Date/value", is a global path and is <a href="#gen_shareArnobj">shared</a> to ARN server and clients.</li>
<li>First level folder starts with "@", e.g. "/@SomeServer/MyFolder/Date/value", is a shared path and is <a href="#gen_shareArnobj">shared</a> to an ARN server (typically with some other remote path).</li>
<li>First level folder is "/Local", e.g "/Local/Key/value", is a <a href="#gen_localPath">local path</a> and is not <a href="#gen_shareArnobj">shared</a>.</li>
<li>Path is relative, e.g "Key/value", is a <a href="#gen_localPath">local path</a> and is not <a href="#gen_shareArnobj">shared</a>.</li>
<li>When a leaf is used as an attribute, the following names are reserved:<ul>
<li><b>value</b> the value of the above closest folder denotation, e.g. "Temperature/value" (=10).</li>
<li><b>name</b> the describtion of the above closest folder denotation, e.g. "Server-1/name" (="Hugin").</li>
<li><b>set</b> allowed values and conversion to a more descriptive form, e.g. "0=Off 1=On".</li>
<li><b>bitSet</b> used bits and conversion to a more descriptive form, e.g. "B0=Read B1=Write".</li>
<li><b>property</b> like precision and unit, e.g. "prec=1 unit=°C".</li>
<li><b>info</b> like tool tips, e.g. "&lt;tt\&gt;Standard UV radiation index&lt;/tt\&gt;".</li>
<li>**help.**XXX like "help.xhtml" contains help in xhtml format. <br />
<br />
</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="gen_bidirArnobj"></a>
Bidirectional Arn Data Objects    </h2>
<p>A bidirectional <em>ARN Data Object</em> is actually a double object, a twin. Each part has its own path but their life span is depending on each other.</p>
<p>One part is the normal "official" and the other part is <em>provider</em>. The provider has an added "!" to the normal path, e.g. normal = "//Measure/Depth/value", provider = "//Measure/Depth/value!".</p>
<p>Data written to one part ends up in the other. This can be compared to crossing electrical lines from one unit to another unit regarding transmit and receive signals in each unit. When a provider slot is connected to the provider part (<a class="el" href="class_arn_item.html" title="Handle for an Arn Data Object. ">ArnItem</a>), the slot will receive "request" data from the normal part. The provider slot processes the request data and writes the result to the same provider part. This way the result will end up in the normal "official" part.</p>
<p>This functionality can typically be used for data validation and limiting.</p>
<p>The crossing property of BiDir can be supressed by using <a class="el" href="class_arn_item.html#a3c15bad50954e05992fe35b5441540b7" title="Set a Bidirectional item as Uncrossed. ">ArnItem::setUncrossed()</a>. Again this can be compared to uncrossed electrical lines from a unit to a "communicator" (modem, switch, hub ...) regarding transmit and receive signals. Not supprisingly this is usually a easier mode when making some kind of Bridge for ARN.</p>
<p><br />
<br />
</p>
<h2><a class="anchor" id="gen_pipeArnobj"></a>
Pipe Arn Data Objects    </h2>
<p><em>Pipes</em> also use the <a href="#gen_bidirArnobj">bidirectional</a> functionality. The two (twin) parts are then named <em>requester</em> and <em>provider</em>.</p>
<p>All data put into a pipe are part of a stream and as such will be fully transfered (synchronized) if they are <a href="#gen_shareArnobj">shared</a> with a server and other clients.</p>
<p><a class="el" href="class_arn_pipe.html" title="ArnItem specialized as a pipe. ">ArnPipe</a> is a specialized class for handling pipes. <br />
 It contains logic for handling <a href="#gen_pipeSeqCheck">sequence check</a> and <a href="#gen_pipeAntiCongest">anti congest</a>.</p>
<p>Data stream to and from a pipe can be controlled using <a class="el" href="class_arn_item_valve.html" title="Valve for controlling stream to/from an ArnItemB. ">ArnItemValve</a> class. Actually <a class="el" href="class_arn_item_valve.html" title="Valve for controlling stream to/from an ArnItemB. ">ArnItemValve</a> can controll any <a class="el" href="class_arn_item_b.html" title="Base class handle for an Arn Data Object. ">ArnItemB</a> derived class. <br />
<br />
</p>
<h3><a class="anchor" id="gen_pipeSeqCheck"></a>
Pipe sequence check</h3>
<p>Sequence check is used to make sure everything is received and nothing is lost or comes twice. This might happen when a tcp/ip connection goes up and down.</p>
<p>The sequence check uses a hidden sequence number not visible in the pipe stream. The sequence number is increased for each assignment to the pipe. The sending and checking of this sequence number is activated at each end of the pipe.</p>
<p>When checking is activated and the received sequence number is unexpected, a signal will be generated.</p>
<p>See also <a class="el" href="class_arn_pipe.html#a00cece801ca692319e31f877acc01da5" title="Change usage of sending sequence numbers. ">ArnPipe::setSendSeq()</a>, <a class="el" href="class_arn_pipe.html#a77316d8b09159df3af9a3c9ff3a2d3f6" title="Change usage of checking received sequence numbers. ">ArnPipe::setCheckSeq()</a>, <a class="el" href="class_arn_pipe.html#a0f85c1dfd3e25859b7a4e183bc79c095" title="Signal emitted when the received sequence numbers are &quot;out of sequence&quot;. ">ArnPipe::outOfSequence()</a>. <br />
<br />
</p>
<h3><a class="anchor" id="gen_pipeAntiCongest"></a>
Pipe anti congest</h3>
<p>When the pipe is a <a href="#gen_shareArnobj">shared oject</a>, all assignment to the pipe is queued up in a send queue. If there is a disconnect in the tcp/ip, an <a class="el" href="class_arn_server.html" title="Class for making an Arn Server. ">ArnServer</a> will drop the send queue. But in an <a class="el" href="class_arn_client.html" title="Class for connecting to an Arn Server. ">ArnClient</a>, this send queue will grow out of control if assignments to the pipe keeps coming. This problem can also arise with a fast rate of status messages on a slow network.</p>
<p>One possibility is to keep track of the connection status, but this involves knowing about which <a class="el" href="class_arn_client.html" title="Class for connecting to an Arn Server. ">ArnClient</a> (if many) to get status from. It also doesn't handle the problem with a slow network.</p>
<p>A probably better way is to use the <em>Pipe anti congest</em> logic. <br />
 We identify <em>messages</em> that can be sent any number of times and are used to check the data flow, resending, status and alike. Typically this can be <em>Heart beat</em>, <em>ping</em>, <em>request update</em>, <em>current time</em> etc. These <em>async messages</em> are assigned using <a class="el" href="class_arn_pipe.html#aad5fc92f4a68006c4ae6098de0bdc539" title="Assign a QByteArray to a Pipe by using Anti congest logic. ">ArnPipe::setValueOverwrite()</a>.</p>
<p>A regular expression is needed to identify "equal" <em>async messages</em>, that can be overwritten in the send queue. If <em>async messages</em> are repeatedly assigned to a pipe by <a class="el" href="class_arn_pipe.html#aad5fc92f4a68006c4ae6098de0bdc539" title="Assign a QByteArray to a Pipe by using Anti congest logic. ">ArnPipe::setValueOverwrite()</a>, the send queue will then not grow.</p>
<p>All other <em>messages</em> will be normally assigned to the pipe. But these <em>messages</em> will only be assigned when normal data flow is present. Typically there is some expected <em>feedback message</em> from the receiving part to block uncontrolled assignment from one side of the pipe. <br />
<br />
</p>
<h2><a class="anchor" id="gen_persistArnobj"></a>
Persistent Arn Data Objects    </h2>
<p>The <em>server</em> must use <a class="el" href="class_arn_persist.html" title="Class for handling persistent Arn Data object. ">ArnPersist</a> to support the persistance service. As a standard <em>persist storage</em>, <em>ARN Data Objects</em> are stored in a SQLite database. It's also possible to store each object as a file.</p>
<p>The <em>mount point</em> (path) for collecting the persistent <em>ARN Data objects</em> is set by <a class="el" href="class_arn_persist.html#a5a5df6121afbf16f1980093001aafdd4" title="Set the persistent enabled tree path. ">ArnPersist::setMountPoint()</a>. For server applications this is typically set to "/", which makes all <em>ARN Data Objects</em> potential persistent. In client applications the <em>mount point</em> is typically restricted to <a class="el" href="namespace_arn.html#a690f9202c122418e5dfd8784529da8d9">Arn::pathLocal</a>, which only saves local <em>ARN Data Objects</em> in the local <em>persist storage</em>.</p>
<p>Any connected <em>client</em> or the <em>server</em> can make an <em>ARN Data Object</em> persistent. Just open an <a class="el" href="class_arn_item.html" title="Handle for an Arn Data Object. ">ArnItem</a> to the object and change <em>mode</em> to <em>Save</em>. </p><div class="fragment"><div class="line"><a class="code" href="class_arn_item.html">ArnItem</a>  arnMaxLevel;</div><div class="line">arnMaxLevel.<a class="code" href="class_arn_item.html#a9b05c84369d7a5d3c68f113f79189b1a">addMode</a>( <a class="code" href="class_arn_1_1_object_mode.html#a1b35282c90d50d65d184265d5b545155aa1a11a93f3421a36c42c54910d4e7c0b">Arn::ObjectMode::Save</a>);</div><div class="line">arnMaxLevel.<a class="code" href="class_arn_item_b.html#a0cecde39f435ba1c62f2587b00b930c1">open</a>(<span class="stringliteral">&quot;//Config/Level/Max/value&quot;</span>);</div></div><!-- fragment --><p>When the <em>ARN Data Object</em> is set to <em>Save</em> mode, it's automatically loaded by the <a class="el" href="class_arn_persist.html" title="Class for handling persistent Arn Data object. ">ArnPersist</a>. At the <em>server</em> this is instantly done. A <em>client</em> has to wait for the value to get synced from the <em>server</em>. It's convenient to use <a class="el" href="class_arn_depend.html" title="Class for setting up dependencis to needed services. ">ArnDepend</a> to get a signal when the value is loaded and ready to use.</p>
<p>When the <em>ARN Data Object</em> is changed, it will be automatically saved by <a class="el" href="class_arn_persist.html" title="Class for handling persistent Arn Data object. ">ArnPersist</a>. There is a delay from first change of the object until the saving is done, see <a class="el" href="class_arn_item.html#a2487337c3924ea323ec6462b8b0aee08" title="Set delay of data changed signal. ">ArnItem::setDelay()</a>. This allows for intensive updates of the object without choking down the server with saving operations.</p>
<p>It's possible to mark an object in the SQLite data base as <em>mandatory</em>. In this way the <em>ARN Data Object</em> is set as <em>persistent</em> and gets loaded at start of <a class="el" href="class_arn_persist.html" title="Class for handling persistent Arn Data object. ">ArnPersist</a>. <br />
<br />
</p>
<h3><a class="anchor" id="gen_fileArnobj"></a>
Saving objects in files</h3>
<p>To use the <em>persistent</em> storing of <em>ARN Data Objects</em> in files, the <em>root</em> directory is set by: <a class="el" href="class_arn_persist.html#a34de416764dae40d9d3b6ab962ed2a8a" title="Set the persistent file directory root ">ArnPersist::setPersistDir()</a>. This can also be combined with support of VCS (version control system). See <a class="el" href="class_arn_persist.html#a91359d742060af64cd3853806cdb9b8e" title="Set the Version Control System to be used. ">ArnPersist::setVcs()</a>. Currently there is a support module for <em>git</em>.</p>
<p>In the <em>root</em> directory and below, all (VCS) persistent files are stored. The <em>root</em> directory corresponds to the <em>root</em> in Arn tree.</p>
<blockquote class="doxtable">
<p>Example: <em>root</em> directory is set to "/usr/local/arn_persist". There is a file stored at "/usr/local/arn_persist/@/doc/help.xhtml". This file will be mapped to Arn at "//doc/help.xhtml". </p>
</blockquote>
<p>Any files stored in the <em>root</em> directory and below, get loaded into their <em>ARN Data Object</em> with <em>mode</em> set as <em>persistent</em> at start of <a class="el" href="class_arn_persist.html" title="Class for handling persistent Arn Data object. ">ArnPersist</a>.</p>
<p>The files get updated in a similar way to the data base update. <br />
<br />
</p>
<h2><a class="anchor" id="gen_shareArnobj"></a>
Sharing Arn Data Objects    </h2>
<p>A fundamental aspect of Arn is that <em>ARN Data Objects</em> can be shared. This is centralized to the <em>ARN Server</em>, which stores all shared objects. It's still a distributed model as each client and server has their own set of <em>ARN Data Objects</em> that operate independent of any connection.</p>
<p>Each <em>ARN Client</em> connects to the <em>ARN Server</em> and decides which part of the <em>ARN Data Object</em> tree to be shared. <br />
 <code><a class="el" href="class_arn_client.html#ac417b3db210850f4bea8abcf78bf1237" title="Add a sharing tree path. ">ArnClient::addMountPoint</a>("/Share/")</code> will make the tree "/Share/" shared. <br />
 This doesn't mean that everything in the shared tree at the server now will be available at the client. The client has to create an <em>ARN Data Object</em> in the shared tree. The client can then decide the exact objects of interest. <br />
 <code>ArnItem::Open("/Share/Test/value")</code> will open a shared object in previous example.</p>
<p>Note: Normally "//" or "/@.../" is used for shared. See <a href="#gen_naming">naming conventions</a>.</p>
<p>The remote tree can be at a different path than the local tree (mount point). </p><div class="fragment"><div class="line"><a class="code" href="class_arn_client.html#ac417b3db210850f4bea8abcf78bf1237">ArnClient::addMountPoint</a>(<span class="stringliteral">&quot;/@Host/&quot;</span>, <span class="stringliteral">&quot;/&quot;</span>)  <span class="comment">// Makes the server shared at &quot;/@Host/&quot;.</span></div><div class="line"><a class="code" href="class_arn_item.html">ArnItem</a>::open(&quot;/@Host/Share/Test/value&quot;)  <span class="comment">// Open the shared object in previous example.</span></div></div><!-- fragment --><p> <br />
<br />
</p>
<h3><a class="anchor" id="gen_dynamicPort"></a>
Dynamic port</h3>
<p>An <a class="el" href="class_arn_server.html" title="Class for making an Arn Server. ">ArnServer</a> can be created with <em>port</em> set to 0. This will be handled as a <em>dynamic port</em> and the system will assign a free <em>port number</em> to the server. The <em>port number</em> will be taken from a range specified by IANA.</p>
<p>This can typically be used to skip configuring static port numbers and be able to have multiple instanses of the <a class="el" href="class_arn_server.html" title="Class for making an Arn Server. ">ArnServer</a> on the same machine. As an <a class="el" href="class_arn_client.html" title="Class for connecting to an Arn Server. ">ArnClient</a> must find its <a class="el" href="class_arn_server.html" title="Class for making an Arn Server. ">ArnServer</a>, this can be used together with <a class="el" href="class_arn_discover_remote.html" title="Discover with remote setting. ">ArnDiscoverRemote</a> / <a class="el" href="namespace_arn_discover.html">ArnDiscover</a>. <br />
<br />
</p>
<h2><a class="anchor" id="gen_syncRules"></a>
Sync rules    </h2>
<p>Syncing between client and server is normally handled automatically, but for special needs and reference this chapter gives an idea of the rules. Also this describes the rules when connection is established. After that, normal syncing is done almost symetrically between client and server.</p>
<p>An <em>ARN Data Object</em> with Master <a href="#gen_arnobjModes">Mode</a> is used as <em>default generator</em> of data. Normally the server is the <em>default generator</em> of data. This makes difference when client connects or reconnects to the server. The data from the <em>default generator</em> is then used and synced.</p>
<p>Also to have minimal data exchange when using non <a href="#gen_bidirArnobj">BiDirectional</a> <em>ARN Data Object</em>, one should take Master mode into consideration. This is more important for big objects.</p>
<p>When a Null value is synced, the receiver store this as an empty value, i.e. it't not stored as Null which is impossible.</p>
<h3><a class="anchor" id="gen_syncRulesPipe"></a>
Sync rules for Pipe</h3>
<ul>
<li>Pipes should be considered to carry a flow, not a value.</li>
<li>The pipe flow (to server) is enabled after <a class="el" href="class_arn_client.html#a0fd4daab4ef28a0ab98db7d7e5f3f057" title="Connect to an Arn Server ">ArnClient::connectToArn()</a>, and is disabled after <a class="el" href="class_arn_client.html#a980db214281284dee96e1504d3b0d17a" title="Close sharing with an Arn Server ">ArnClient::close()</a>.</li>
<li>In client, an enabled flow can queue up the stream of data when there is no connection to server.</li>
<li>In client, the flow keeps being enabled even if the <a class="el" href="class_arn_client.html#a0fd4daab4ef28a0ab98db7d7e5f3f057" title="Connect to an Arn Server ">ArnClient::connectToArn()</a> fails or there is a TCP disconnect.</li>
<li>When the flow is disabled (<a class="el" href="class_arn_client.html#a980db214281284dee96e1504d3b0d17a" title="Close sharing with an Arn Server ">ArnClient::close</a>), all queued stream data will be sent if possible.</li>
<li>Server can never queue anything when disconnected, as the server session is only living when connected. <br />
<br />
</li>
</ul>
<h3><a class="anchor" id="gen_syncRulesMode"></a>
ClientSyncMode</h3>
<p>ClientSyncMode can be set with <a class="el" href="class_arn_client.html#a33ac43100792c358069c34a9ef0a918d" title="Set ClientSyncMode. ">ArnClient::setSyncMode()</a>. Basically this controls if a client <em>ARN Data Object</em> is considered as a Master object (se also <a href="#gen_arnobjModes">Modes</a> ).</p>
<p>ClientSyncMode doesn't affect a pipe. Default mode is StdAutoMaster.</p>
<ul>
<li><b>StdAutoMaster</b> Dynamic auto master mode, general purpose, prohibit Null value sync. Can be used for one time initial setup, thereafter server can be Master for an object.<ul>
<li>Master can be set explicitly with <a class="el" href="class_arn_item.html#a22de5dfc89c02245370d5c0a89cee3f6" title="Set client session sync mode as Master for this ArnItem. ">ArnItem::setMaster()</a>. This is overided if the <em>ARN Data Object</em> has a Null value (not assigned), then the object becomes temporary Slave for next connection.</li>
<li>If client has an unsynced local update (during not connected state), this <em>ARN Data Object</em> becomes temporary Master for just next connection.</li>
<li>If the client is not Master for an <em>ARN Data Object</em> but the server only has a Null value, the clients value (non Null) is still used.</li>
</ul>
</li>
<li><b>ImplicitMaster</b> First local assign gives permanent Master mode, typically a client value reporter.<ul>
<li>Master can be set explicitly with <a class="el" href="class_arn_item.html#a22de5dfc89c02245370d5c0a89cee3f6" title="Set client session sync mode as Master for this ArnItem. ">ArnItem::setMaster()</a>.</li>
<li>Client local assign to an <em>ARN Data Object</em> gives permanent Master mode for this object. This implicit Master mode setting is done once when next connection is established.</li>
<li>Null values can be synced both from client and server.</li>
<li>If a client <em>ARN Data Object</em> is set booth as <a href="#gen_persistArnobj">Persistent</a> and Master with a Null value before connection, the Master mode is initially overridden and the servers value is synced to the client.</li>
</ul>
</li>
<li><b>ExplicitMaster</b> Explicit permanent Master mode, typically an observer or manually setup Master mode. Can be used for UI (User Interface) with no Master set to any <em>ARN Data Object</em>, i.e. the server is always holding the "true" value.<ul>
<li>Master can be set explicitly with <a class="el" href="class_arn_item.html#a22de5dfc89c02245370d5c0a89cee3f6" title="Set client session sync mode as Master for this ArnItem. ">ArnItem::setMaster()</a>. Client has no other way to become Master for an <em>ARN Data Object</em>.</li>
<li>Null values can be synced both from client and server.</li>
<li>If a client <em>ARN Data Object</em> is set booth as <a href="#gen_persistArnobj">Persistent</a> and Master with a Null value before connection, the Master mode is initially overridden and the servers value is synced to the client. <br />
<br />
</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="gen_rpc"></a>
RPC and SAPI    </h1>
<p><a class="el" href="class_arn_rpc.html" title="Remote Procedure Call. ">ArnRpc</a> is the basic functionality of RPC (Remote Procedure Call). <a class="el" href="class_arn_sapi.html" title="Service API. ">ArnSapi</a> implements SAPI (Service Application Programming Interface) and is using <a class="el" href="class_arn_rpc.html" title="Remote Procedure Call. ">ArnRpc</a> as its base. It's recommended to use <a class="el" href="class_arn_sapi.html" title="Service API. ">ArnSapi</a> which has a higher level model.</p>
<p>The SAPI works by a model which can be described as RPC by <em>remote signal slots</em>. The <em>provider</em> is usually assumed to wait for a <em>requester</em> to initiate the session and then react to different remote calls from the <em>requester</em>. However, this is full duplex, so any side can make a remote call at any time.</p>
<p>A good example of the usage of SAPI is the "Arn Demo Chat", which is included in the source package of the ArnLib.</p>
<p><a class="el" href="class_arn_rpc.html" title="Remote Procedure Call. ">ArnRpc</a> uses <a class="el" href="gen_page.html#gen_pipeArnobj">pipes</a> to communicate. The <em>pipes</em> can be monitored and receive test stimuli from the "Arn Browser" program. The used <a href="#gen_rpcformat">protocol</a> is XString based and quite easy to handtype when common data types are used. "$help" will give the syntax for the actual custom SAPI.</p>
<p>A SAPI is setup by deriving the <a class="el" href="class_arn_sapi.html" title="Service API. ">ArnSapi</a> class to a new class that defines the <em>custom SAPI</em>. This custom-declared class is included at both the <em>provider</em> and <em>requester</em> ends. The <em>custom SAPI</em> class by itself doesn't implement any <em>services</em>. It's merely a hub for connections to <em>external signals and slots</em>. The base <a class="el" href="class_arn_sapi.html" title="Service API. ">ArnSapi</a> class automatically transfers all <em>custom signal</em> (SAPI) calls to the remote connected ends, which also have the <a class="el" href="class_arn_sapi.html" title="Service API. ">ArnSapi</a> derived class and that emits the transfered signal. See example in <a class="el" href="class_arn_sapi.html" title="Service API. ">ArnSapi</a> Detailed Description.</p>
<p>The provider connects the signals from custom SAPI that are prefixed with "pv_" (as default) to each external slot that implements the services. In the same way the <em>requester</em> connects the signals prefixed with "rq_" to its external "service" slots.</p>
<p>When there is a naming pattern between the <em>SAPI services</em> and the <em>external signals and slots</em>, it's a great convenience to use <a class="el" href="class_arn_rpc.html#a7ca8fb2b69da0d553cc86f97262de007" title="Make batch connection from one senders signals to another receivers slots/signals. ">ArnRpc::batchConnect()</a>, <a class="el" href="class_arn_sapi.html#a48fc7203b188b0af970a8fb3625d4cf7" title="Make batch connection from this ArnSapi:s signals to another receivers slots/signals. ">ArnSapi::batchConnectTo()</a> or <a class="el" href="class_arn_sapi.html#a3913bd932c51c56aa3d940d41ee4b72b" title="Make batch connection from one senders signals to this ArnSapi:s signals. ">ArnSapi::batchConnectFrom()</a>. This saves a lot of QObject::connect() calls. Also newly added services in the SAPI, that obey the naming scheme, will automaically be connected to the newly matching <em>external signals and slots</em> for implementation of the <em>service</em>.</p>
<p>An extended feature comparing to normal <em>signals</em> is that the <em>SAPI signals</em> are <em>public</em> and can be called by non-derived classes. This makes it optional to use both <em>signal to signal</em> connections or direct <em>signal</em> calls (emit), when issuing a RPC to the remote side.</p>
<p>The <em>service</em> slot can get the emitting <em>custom SAPI</em> object by using normal QObject::sender() functionality. <br />
<br />
</p>
<h2><a class="anchor" id="gen_rpcoverload"></a>
RPC and SAPI method name overload    </h2>
<p>Under the hood Qt converts a signal that uses default argument(s) into methods with same name and all variation of the arguments. I.e. One method with all arguments, one with all but the last default argument, and so on until there is no more default arguments. When emitting the signal with some number of arguments, all of the signal methods will be exited.</p>
<p><a class="el" href="class_arn_rpc.html" title="Remote Procedure Call. ">ArnRpc</a> has to deal with this default argument mechanism, otherwise there would be multiple calling messages for just one original signal emit.</p>
<p>The problem arises when there also can be normal signals that are overloaded, i.e. using same method name but different arguments. <a class="el" href="class_arn_rpc.html" title="Remote Procedure Call. ">ArnRpc</a> has to be able to differentiate between these normal overloaded signals and the default argument signals described earlier.</p>
<p>These are the alternatives, how you can help <a class="el" href="class_arn_rpc.html" title="Remote Procedure Call. ">ArnRpc</a> make your SAPI work:</p>
<ul>
<li>Don't overload arguments or make sure they don't have a common start of equal names and types. E.g. its ok with: <code>f( int a, int b); f( int b); f( int c); f( uint a);</code></li>
<li>Set <a class="el" href="class_arn_rpc_mode.html#a8edeb6254deec1875e83f6bfb6c4875eae5238e6c47db6964f31dbef017c51dd9" title="If guarantied no default arguments, full member name overload is ok. ">ArnRpc::Mode::NoDefaultArgs</a> and never use any default arguments in the SAPI. It's then ok to use any kind of normal overloading. <br />
<br />
</li>
</ul>
<h2><a class="anchor" id="gen_rpcformat"></a>
RPC and SAPI communication format    </h2>
<p>The RPC calling has a basic format as XString (see <a class="el" href="class_arn_1_1_x_string_map.html" title="Container class with string representation for serialized data. ">Arn::XStringMap</a>). A call message can have 3 possible argument formats: positional, named and typed. The positional format is always possible to use and is most comparable to a standard c++ call.</p>
<p>The method name always come first in the message. After that comes arguments that have the argument data in the value part of its key/value pair. The key part can have the argument type and name, but this depends on the used argument format.</p>
<p>The following RPC data types are available:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">RPC  </th><th class="markdownTableHeadNone">Qt   </th></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">int  </td><td class="markdownTableBodyNone">int   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">uint  </td><td class="markdownTableBodyNone">uint   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">int64  </td><td class="markdownTableBodyNone">qint64   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">uint64  </td><td class="markdownTableBodyNone">quint64   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">bool  </td><td class="markdownTableBodyNone">bool   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">float  </td><td class="markdownTableBodyNone">float   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">double  </td><td class="markdownTableBodyNone">double   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">bytes  </td><td class="markdownTableBodyNone">QByteArray   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">date  </td><td class="markdownTableBodyNone">QDate   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">time  </td><td class="markdownTableBodyNone">QTime   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">datetime  </td><td class="markdownTableBodyNone">QDateTime   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">list  </td><td class="markdownTableBodyNone">QStringList   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">string  </td><td class="markdownTableBodyNone">QString   </td></tr>
</table>
<p>Also generic RPC data types can be formed as: </p><blockquote class="doxtable">
<p>Textual like QColor t&lt;QColor&gt; <br />
 Binary like QPoint tb&lt;QPoint&gt; <br />
 </p>
</blockquote>
<p>Only textual types, i.e. those that can be converted to/from a string, are reasonable to be hand typed.</p>
<p>Lets have an example method to see the message when it is called. </p><blockquote class="doxtable">
<p>Method: void put( QString id, int value); <br />
 Get called by: put("level", 123); </p>
</blockquote>
<p>Alternatives in positional argument format: </p><blockquote class="doxtable">
<p>put t&lt;QString&gt;.id=level t&lt;int&gt;.value=123 <br />
 put string.id=level int.value=123 <br />
 put string.=level int.=123 <br />
 put string=level int=123 <br />
 put level int=123 <br />
 </p>
</blockquote>
<ul>
<li>Argument names are optional and only for human debuging.</li>
<li>When no type is given, "string" is asumed.</li>
<li>When <a class="el" href="class_arn_rpc_mode.html#a8edeb6254deec1875e83f6bfb6c4875ea56a9d4ec583d403ec91ae4dd82c9e3d6" title="When calling out, uses named argument e.g &quot;myFunc count=123&quot;. ">ArnRpc::Mode::NamedArg</a> is active, its not allowed to only use typename, e.g. "int=123" can be "int.=123" to enforce positional format.</li>
<li>Both textual and binary arguments can be used.</li>
</ul>
<p>Alternatives in named argument format: </p><blockquote class="doxtable">
<p>put id=level value=123 <br />
 put value=123 id=level <br />
 put value=123 dummy=ABC id=level garbage=321 <br />
 </p>
</blockquote>
<ul>
<li>Only Argument names are used.</li>
<li>Any order of arguments can be used.</li>
<li>Extra arguments are discarded.</li>
<li>If too few arguments, default constructor is used, e.g. "put value=123" will give id="".</li>
<li>The methods parameter data type is used and only textual types are allowed.</li>
<li>When <a class="el" href="class_arn_rpc_mode.html#a8edeb6254deec1875e83f6bfb6c4875ea56a9d4ec583d403ec91ae4dd82c9e3d6" title="When calling out, uses named argument e.g &quot;myFunc count=123&quot;. ">ArnRpc::Mode::NamedArg</a> is inactive, its not allowed to use an argument name that also is a RPC data type. See table above. E.g. "list" and "string" are not allowed.</li>
<li>Only textual arguments can be used (as stated before).</li>
</ul>
<p>Alternatives in typed argument format: </p><blockquote class="doxtable">
<p>put id:t&lt;QString&gt;=level value:t&lt;int&gt;=123 <br />
 put id:string=level value:int=123 <br />
 put value:int=123 id:string=level <br />
 put value:int=123 dummy:bytes=ABC id:string=level <br />
 </p>
</blockquote>
<ul>
<li>Argument names and types are used.</li>
<li>Only the name is used to match method parameter.</li>
<li>The type is verified with the matching method parameter for error check.</li>
<li>Any order of arguments can be used.</li>
<li>Extra arguments are discarded.</li>
<li>If too few arguments, default constructor is used, e.g. "put value:int=123" will give id="".</li>
<li>Both textual and binary arguments can be used.</li>
</ul>
<p>Named and typed argument format can be mixed, but positional format is never mixed.</p>
<p>List (QStringList) can be used. All examples below will get same resulting call. </p><blockquote class="doxtable">
<p>For a function: void test( QStringList lst, int num) <br />
 test list=red green blu int=3 <br />
 test list.lst=red green blu int.num=3 <br />
 test list= +=red +==green +=blu int=3 <br />
 test list=red +=green blu int=3 <br />
 test lst:list=red green blu num=3 <br />
 test num=3 lst:list=red green +=blu <br />
 </p>
</blockquote>
<ul>
<li>list is both a data type and a syntax for defining its data.</li>
<li>list is only available for positional and typed argument format.</li>
</ul>
<p>For special cases, like empty elements, the += syntax is needed. The example below has a first empty element followed by "green". </p><blockquote class="doxtable">
<p>test list= += green blue int=2 </p>
</blockquote>
<p>The built-in call "$help" will give an automatically generated list of the present SAPI with the syntax for each available service. The default argument format is positional. This can be changed to named format by giving "$help named". <br />
<br />
</p>
<h1><a class="anchor" id="gen_zeroconf"></a>
ZeroConfig    </h1>
<p>For getting a basic understanding of ZeroConfig and further references to relevant documentation, see: <a href="http://zeroconf.org/">http://zeroconf.org/</a></p>
<p><em>ARN ZeroConfig</em> is the lowest level support for advertising and discovering services on a local network. The implementation has very few dependencies to the rest of the ArnLib.</p>
<p><em>ARN ZeroConfig</em> can use a built in implementation of Apple (R) <em>mDns</em> / <em>DNS_SD</em> that has no further dependencies to external libraries. For <em>mDns</em> the low end system abstraction layer has been written to use Qt for portability. The higher level <em>DNS_SD</em> has wrappers written to give a good c++ / Qt API.</p>
<p>It's also possible to use an external <em>DNS_SD</em> library, like <em>Avahi</em>. This gives better performance when many applications uses ZeroConfig on the same machine, as they share cashing etc with a common daemon. However you have to deal with this external dependency.</p>
<p><em>ARN ZeroConfig</em> implementation has two parts. The <a class="el" href="class_arn_zero_conf_register.html" title="Registering a ZeroConfig service. ">ArnZeroConfRegister</a> can be used to advertise any <em>service</em> given a <em>host address</em> and a <em>port number</em>. The other part is the <a class="el" href="class_arn_zero_conf_browser.html" title="Browsing for ZeroConfig services. ">ArnZeroConfBrowser</a> / <a class="el" href="class_arn_zero_conf_resolve.html" title="Resolv a ZeroConfig service. ">ArnZeroConfResolve</a> / <a class="el" href="class_arn_zero_conf_lookup.html" title="Lookup a host. ">ArnZeroConfLookup</a>. The browser is used to get a realtime list of available <em>services</em> on the network. The resolver takes a given <em>service</em> and resolves it into its <em>host name</em> and <em>port number</em>. Finally <a class="el" href="class_arn_zero_conf_lookup.html" title="Lookup a host. ">ArnZeroConfLookup</a> takes a given <em>host name</em> and makes a DNS (mDNS) lookup to get its ip-address. Each of these classes are stand alone and has to be combined with glue logic for the complete process.</p>
<h2><a class="anchor" id="gen_zeroconfDef"></a>
ZeroConfig definitions    </h2>
<p>A ZeroConfig <em>service</em> has a <em>service type</em>, that preferably should be registered at IANA. Examples of <em>service types</em> are "http", "ftp" and "arn". This type is mandatory when advertising a <em>service</em>. Also the <em>service</em> must have a <em>service name</em>. <br />
<br />
</p>
<h3><a class="anchor" id="gen_zeroconfServiceName"></a>
Service name</h3>
<p><em>Service names</em> can be any human readable id. It should be easy to understand, without any cryptic coding. There should not be any attempts to make the <em>service name</em> unique as this is taken care of by the ZeroConfig system. It's common that the <em>service name</em> can be modified by the end user. The default starting name could be some system or product name. Example of <em>service name</em>: "My House Registry". <br />
<br />
</p>
<h3><a class="anchor" id="gen_zeroconfSubTypes"></a>
Sub types</h3>
<p><em>Services</em> can also have <em>sub types</em>. These are identifiers that can be used to filter out some sub group from a specific <em>service type</em>. All <em>services</em> having the same <em>service type</em> must still have some common protocol even if they belong to different <em>sub types</em>. A <em>service</em> can be advertised with many <em>sub types</em>, but browsing can only be filtered with one <em>sub type</em> or with no filter. <br />
<br />
</p>
<h3><a class="anchor" id="gen_zeroconfTextRecord"></a>
Text record</h3>
<p>It's possible to add a <em>text record</em> to a <em>service</em>. The format of this record is specified by IANA. The purpose is to store properties by a <em>key</em> / <em>value</em> -pair. For convenience this can be done with <a class="el" href="class_arn_zero_conf_register.html#a6b29d9c7e4810cc90a40a3f534643b7e" title="Save a XStringMap with parameters to the Txt Record. ">ArnZeroConfRegister::setTxtRecordMap()</a> using an <a class="el" href="class_arn_1_1_x_string_map.html" title="Container class with string representation for serialized data. ">Arn::XStringMap</a>. <br />
<br />
</p>
<h2><a class="anchor" id="gen_discover"></a>
Discover    </h2>
<p><em>ARN Discover</em> is the mid level support for advertising and discovering services on a local network. This implementation is only for the "arn" <em>service type</em> and is heavily dependent on the ArnLib. The "arn" <em>service type</em> is approved and registered by IANA.</p>
<p><em>ARN Discover</em> implementation has two parts. The <a class="el" href="class_arn_discover_advertise.html" title="Advertise an Arn service. ">ArnDiscoverAdvertise</a> can be used to advertise an Arn <em>service</em> given a <em>host address</em> and a <em>port number</em>. The other part is the <a class="el" href="class_arn_discover_browser.html" title="Browsing for Arn services. ">ArnDiscoverBrowser</a> / <a class="el" href="class_arn_discover_resolver.html" title="Resolv an Arn service. ">ArnDiscoverResolver</a>. The browser is used to get a realtime list of available Arn <em>services</em> on the network. The resolver is for taking a manual resolve when a <em>service name</em> is known in advance.</p>
<p><em>ARN Discover</em> is designed to minimize external glue logic as these classes do all the common processing. Internally <em>ARN ZeroConfig</em> is used, but focus is on solving Arn specific needs in a powerful, yet flexible manner.</p>
<p>An <em>ARN service</em> needs an <a class="el" href="struct_arn_discover_1_1_type.html" title="Types of Arn discover advertise. ">ArnDiscover::Type</a> and a <a class="el" href="gen_page.html#gen_zeroconfServiceName">service name</a>. The <a class="el" href="struct_arn_discover_1_1_type.html" title="Types of Arn discover advertise. ">ArnDiscover::Type</a> sets up a coarse division of the applications into the <em>groups</em> "server" and "client". The "client" typically only offer the service of <a class="el" href="class_arn_discover_remote.html" title="Discover with remote setting. ">ArnDiscoverRemote</a>.</p>
<p><em>ARN services</em> can also have <em>groups</em>. These are identifiers that can be used to filter out some sub group. An <em>ARN service</em> can be advertised with many <em>groups</em>, but browsing can only be filtered with one <em>group</em> or with no filter.</p>
<p>It's possible to add a <em>custom property</em> to an <em>ARN service</em>. This can be done with <a class="el" href="class_arn_discover_advertise.html#a970f933dfb0a0efdeed265a6546442d4" title="Set service custom properties. ">ArnDiscoverAdvertise::setCustomProperties()</a> using an <a class="el" href="class_arn_1_1_x_string_map.html" title="Container class with string representation for serialized data. ">Arn::XStringMap</a>. The propertie has a <em>key</em> / <em>value</em> -pair. The custom property are advised to have a <em>key</em> starting with a capital letter to avoid name collision with the system. The added <em>groups</em> will be set as properties with naming as "group0", "group1" ...</p>
<p><a class="el" href="class_arn_discover_browser.html" title="Browsing for Arn services. ">ArnDiscoverBrowser</a> collects found Arn <em>services</em>. Each of these <em>services</em> can automatically be further examined. This is chosen by calling <a class="el" href="class_arn_discover_browser_b.html#a4bad05f511aa7857b8fa6dc6503d615b" title="Set the default stop state for this service discover browser. ">ArnDiscoverBrowserB::setDefaultStopState()</a>, which e.g. tells examination to stop after <em>host name</em> has been found. The <em>service</em> can then manually be ordered for further examination by <a class="el" href="class_arn_discover_browser_b.html#a54fc5330cee42ff1895ded27ae647e46" title="Command a service to go towards a stop state. ">ArnDiscoverBrowserB::goTowardState()</a>, e.g. examination should now stop after <em>host ip</em> is found.</p>
<p>All the information about a <em>service</em> is stored in <a class="el" href="class_arn_discover_info.html" title="Class for holding current discover info of one service. ">ArnDiscoverInfo</a>. Found <em>services</em> can be accessed by index, id or <em>service name</em>. Increasing index, starting at 0, gives a list of <em>services</em> alfabetically sorted by <em>service name</em>. The index is kind of volatile and should be used instantly, not be stored. The id gives a unique number for each service and can be stored. However the <em>service</em> given by the id might dissapear. <br />
<br />
</p>
<h2><a class="anchor" id="gen_discoverRemote"></a>
Discover remote    </h2>
<p><em>ARN Discover Remote</em> is the highest level support for advertising and discovering services on a local network. Its implementation is based on <em>ARN Discover</em>. The added functionality is to have a remote control for both advertising an <a class="el" href="class_arn_server.html" title="Class for making an Arn Server. ">ArnServer</a> and multiple <a class="el" href="class_arn_client.html" title="Class for connecting to an Arn Server. ">ArnClient</a> connections. The remote control is done via <em>ARN Data Objects</em> in <a href="#gen_localPath">local path</a> "Sys/Discover/".</p>
<p><em>ARN Discover Remote</em> has one main class, <a class="el" href="class_arn_discover_remote.html" title="Discover with remote setting. ">ArnDiscoverRemote</a> which act as a central point. The <a class="el" href="class_arn_discover_remote.html" title="Discover with remote setting. ">ArnDiscoverRemote</a> class also takes an <a class="el" href="class_arn_server.html" title="Class for making an Arn Server. ">ArnServer</a> and advertises it as a <em>service</em>. For remote control the <em>service name</em> is available at <a href="#gen_localPath">local path</a> "Sys/Discover/This/Service/value".</p>
<p><a class="el" href="class_arn_discover_remote.html" title="Discover with remote setting. ">ArnDiscoverRemote</a> can make an internal <a class="el" href="class_arn_server.html" title="Class for making an Arn Server. ">ArnServer</a>, when there is no need to access the <a class="el" href="class_arn_server.html" title="Class for making an Arn Server. ">ArnServer</a> class. This is usually the case in an client application. The <a class="el" href="class_arn_server.html" title="Class for making an Arn Server. ">ArnServer</a> is then merely used to make the discover functionality remote controlled.</p>
<p>Remote controlled client connections can be added. Each <a class="el" href="class_arn_client.html" title="Class for connecting to an Arn Server. ">ArnClient</a> is handled by an <a class="el" href="class_arn_discover_connector.html" title="An automatic client discover connector. ">ArnDiscoverConnector</a> instance, which is made by <a class="el" href="class_arn_discover_remote.html#a0c79190e45f240469478465599910397" title="Create and return an ArnDiscoverConnector for handling remote client. ">ArnDiscoverRemote::newConnector()</a>. Connections can be added to <a class="el" href="class_arn_discover_connector.html" title="An automatic client discover connector. ">ArnDiscoverConnector</a>, both as a <em>direct host</em> list and a <em>discover host</em>.</p>
<p>The <em>discover host</em> is indirerctly set, by adding an <a class="el" href="class_arn_discover_resolver.html" title="Resolv an Arn service. ">ArnDiscoverResolver</a> to <a class="el" href="class_arn_discover_connector.html" title="An automatic client discover connector. ">ArnDiscoverConnector</a>. A <em>service name</em> can then be resolved into the <em>discover host</em>.</p>
<p>The two connection methods can coexist and as standard the <em>discover host</em> has lower priority number than <em>direct host</em>, i.e. <em>discover host</em> is tried first.</p>
<p>The <a class="el" href="class_arn_discover_connector.html" title="An automatic client discover connector. ">ArnDiscoverConnector</a> is associated with an <em>id</em>, which should be chosen to describe the client target or its purpose. It's not a host address or necessarily a specific host, as there can be many possible addresses assigned to the <a class="el" href="class_arn_discover_connector.html" title="An automatic client discover connector. ">ArnDiscoverConnector</a>.</p>
<p>The <em>id</em> will appear as an <em>ARN folder</em> in <a href="#gen_localPath">local path</a>, e.g. when <em>id</em> is "WeatherData-XYZ" the folder path will be "Sys/Discover/Connect/WeatherData-XYZ/". The folder and its sub folders will contain <em>ARN Data Objects</em> to remote control the <a class="el" href="class_arn_client.html" title="Class for connecting to an Arn Server. ">ArnClient</a>. For a more comprehensive description of these objects, see <a class="el" href="help_disc_discover.html">help discover description</a>.</p>
<p>In the above example, a <em>discover host</em> can be remote controlled by setting the <em>service name</em> in <a href="#gen_localPath">local path</a> "Sys/Discover/Connect/WeatherData-XYZ/DiscoverHost/Service/value", e.g. to "Region Weather XYZ".</p>
<p>Also in the above example, the first <em>direct host</em> can be remote controlled by setting the <em>host name</em> in <a href="#gen_localPath">local path</a> "Sys/Discover/Connect/WeatherData-XYZ/DirectHosts/Host-0/value", e.g. to "localhost".</p>
<p>Normally it's wanted that any remote set values in the <a href="#gen_localPath">local path</a> remains after power cycling. This is supported by the <a href="#gen_persistArnobj">Arn persist system</a>.</p>
<p>Connecting via resolver uses the logic:</p><ul>
<li>If connection fails for a <em>discover host</em>, resolving is forced to be refreshed for the target <em>service name</em>. The Host for the <em>service name</em> might have changed since last resolved and doing a refresh can get the new <em>discover host</em>.</li>
<li>If connection continues to fail for a <em>discover host</em>, refreshing the resolv will have a blocking time to avoid spamming the net. Typically this time is 30 seconds, but it can be changed by <a class="el" href="class_arn_discover_connector.html#a1bafcd54487202a76cb10737d0133a52" title="Set the resolv refresh period. ">ArnDiscoverConnector::setResolveRefreshTimeout()</a>. <br />
<br />
</li>
</ul>
<h1><a class="anchor" id="gen_appnote"></a>
Application notations    </h1>
<ul>
<li>If any graphics are used, Gui must be included.</li>
<li>Qt4: For console application only using QImage, Windowing system can be off, like: QApplication a(argc, argv, false);</li>
<li>Qt5: For console application needing QImage, use QApplication a(argc, argv) and start application with flags "-platform offscreen". </li>
</ul>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Tue Feb 22 2022 01:34:36 for ArnLib by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
